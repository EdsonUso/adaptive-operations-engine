- name: RestartWebService
  preconditions:
    service_web_healthy: false
  effects:
    service_web_healthy: true
    cpu_load_high: false # EFEITO: Reiniciar o serviço também resolve a alta carga de CPU
    port_9090_in_use: false # EFEITO: Reiniciar também libera a porta (se estava bloqueada pelo próprio app)
  cost: 15 # Custo mais alto, pois é uma ação mais drástica
  executor:
    type: "http"
    method: "POST"
    url: "http://service-manager:8081/actions/restart-container"
    body: '{ "containerName": "aoe-target-app" }'

- name: KillProcessBlockingPort
  preconditions:
    port_9090_in_use: true
  effects:
    port_9090_in_use: false
  cost: 8
  executor:
    type: "http"
    method: "POST"
    url: "http://service-manager:8081/actions/kill-process-on-port"
    body: '{ "port": 9090 }'

- name: DiagnoseSystemState # Ação de fallback genérica
  preconditions: {} # Sem pré-condições, pode sempre ser usada
  cost: 1
  executor:
    type: "http"
    method: "POST"
    url: "http://service-manager:8081/diagnostics/check-port" # Endpoint que retorna um conjunto abrangente de fatos
    body: '{}'
